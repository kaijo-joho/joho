<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
	<style id="critical-colors">
	  html { color:#191919; color-scheme: light dark; background: transparent; }
	  @media (prefers-color-scheme: dark) {
	    html { color:#e6e6e6; color-scheme: dark light; background: transparent; }
	  }
	  body { background-color:#f3f3f3; }
	  @media (prefers-color-scheme: dark) {
	    body { background-color:#0b0b0b; }
	  }
	</style>
  <title>海城中学高等学校 情報科</title>
  <script defer src="./js/main.js"></script>
</head>
<body>
	
  	
	

	<section>
    <article>
      <h2 id="headline_1">(1) ２つのデータの関係性</h2>

      
      <h3>散布図</h3>
      <p>２つのデータの関係性を調べるために、それぞれのデータを縦軸と横軸にとり、グラフ上にプロットした図を<strong>散布図</strong>といいます。</p>
      
      <p class="center"><img src="./img/ss33_001.png"></p>
      
      
      <h3>相関</h3>
      <p>２つのデータの関係を<strong>相関</strong>といいます。</p>
      <p>また、２つのデータの相関の強さを$-1$〜$1$の値で表した値を<strong>相関係数</strong>といいます。</p>

      
      <ul>
        <li><strong>正の相関</strong></li>
          <ul>
            <li>一方が増加すると他方も増加する傾向が見られるとき、２つのデータには<b>正の相関がある</b>といいます。</li>
          </ul>
        <li><strong>負の相関</strong></li>
          <ul>
            <li>一方が増加すると他方が減少する傾向が見られるとき、２つのデータには<b>負の相関がある</b>といいます。</li>
          </ul>
        <li><strong>無相関</strong></li>
          <ul>
            <li>２つのデータに相関がないとき、<b>無相関</b>といいます。</li>
          </ul>
      </ul>
      
      <table>
        <tr>
          <th>負の相関</th>
          <th>無相関</th>
          <th>正の相関</th>
        </tr>
        <tr>
          <td><img src="./img/ss33_102.png"></td>
          <td><img src="./img/ss33_103.png"></td>
          <td><img src="./img/ss33_101.png"></td>
        </tr>
        <tr>
          <td>相関係数 $r = -0.9$</td>
          <td>相関係数 $r = 0$</td>
          <td>相関係数 $r = 0.9$</td>
        </tr>
      </table>
      <p>$r = 1$のときはすべてのプロットが$y = x$のグラフ上に、$r = -1$のときはすべてのプロットが$y = -x$のグラフ上に分布します。</p>

      <h4>相関係数の解釈</h4>
      <p>一般的に、次のような基準で相関係数を解釈されます（文献によって多少異なります）。</p>
      
      <table>
        <tr>
          <th><span class="transparent">______</span> 〜 $-0.6$</th>
          <td>負の相関が強い</td>
        </tr>
        <tr>
          <th>$-0.6$ 〜 $-0.2$</th>
          <td>弱い負の相関がある</td>
        </tr>
        <tr>
          <th>$-0.2$ 〜 $+0.2$</th>
          <td>相関が弱い、または無相関</td>
        </tr>
        <tr>
          <th>$+0.2$ 〜 $+0.6$</th>
          <td>弱い正の相関がある</td>
        </tr>
        <tr>
          <th>$+0.6$ 〜 <span class="transparent">______</span></th>
          <td>正の相関が強い</td>
        </tr>
      </table>

      
      <p class="center"><img src="./img/ss33_104.png" style="width: 100%"></p>


      <h3>散布図行列</h3>
      <p>複数のデータ間の散布図や相関係数を表形式で表したものを<strong>散布図行列</strong>といいます。次の表は、散布図行列の一例で、同じデータのセルにはヒストグラムを表示し、重複するセルの片方には相関係数を表示しています。今回のように、複数の異なる変数がある場合には、このような表で可視化すると、各データの関係がわかりやすくなります。</p>
      <table class="bg-none">
        <tr class="bg-none">
          <th></th>
          <th width="190px">長さ(km)</th>
          <th width="190px">流域面積(千km^2)</th>
          <th width="190px">平均流量(m^3/s)</th>
        </tr>
        <tr class="bg-none">
          <th>長さ(km)</th>
          <td><img src="./img/ss33_931.png"></td>
          <td>0.625</td>
          <td>0.448</td>
        </tr>
        <tr class="bg-none">
          <th>流域面積(千km^2)</th>
          <td><img src="./img/ss33_932.png"></td>
          <td><img src="./img/ss33_933.png"></td>
          <td>0.836</td>
        </tr>
        <tr class="bg-none">
          <th>平均流量(m^3/s)</th>
          <td><img src="./img/ss33_934.png"></td>
          <td><img src="./img/ss33_935.png"></td>
          <td>
            <img src="./img/ss33_936.png">
            <span style="font-size: 8px;">（※アマゾン川とコンゴ川を除く）</span>
          </td>
        </tr>
      </table>
      
      
      <h3>因果関係と相関関係</h3>
      <p>因果関係とは、2つのデータ間に「原因と結果の関係がある状態」をいいます。相関関係があったとしても、因果関係があるとは限りませんので、データの解釈をするときには注意が必要です。</p>
      
      <p>例えば、国ごとの「チョコレートの消費量」と「その国から出るノーベル賞受賞者の数」には正の相関が見られるという<a href="https://www.nejm.org/doi/full/10.1056/nejmon1211064" target="_blank">調査結果</a>があります。これは、チョコレートを多く食べると、チョコレート内の成分により、学力が向上したり、人類の発展に貢献するようなアイデアが生まれたり、地道な研究を粘り強く行える人になり、結果的にノーベル賞を取れるようになるのでしょうか？</p>
      <p class="center">
        <img src="./img/ss33_111.png" width="400px">
      </p>
      
      <p>チョコレートを摂取すると、多少の記憶力の改善はみられるという<a href="https://www.nature.com/articles/nn.3850" target="_blank">調査結果</a>はあるようですが、ノーベル賞を受賞するほどの効果はないでしょう。</p>
      <p>チョコレートは嗜好品なので、経済力のある裕福な国での消費量が多くなる傾向があります。また、そのような国は教育水準が高いので、その結果、ノーベル賞を受賞できる研究者を輩出できる可能性が高くなるといえるでしょう。</p>
      <p class="center">
        <img src="./img/ss33_112.png" width="340px">
      </p>
      <p>このように、因果関係がないのに、別の原因によってあたかも因果関係があるように見える現象のことを<strong>疑似相関</strong>といい、その原因となる第3の要素を<strong><span class="tooltip" tooltip-data="こうらくいんし">交絡因子</span></strong>といいます。</p>

		</article>


    
    
    <article>
      <h2 id="headline_2">(2) 回帰分析</h2>
      <h3>回帰分析とは</h3>
      <p>相関を説明するために、最もよく当てはまる数式で表現する手法を<strong>回帰分析</strong>といい、この数式を<strong>回帰式</strong>といいます。</p>
      
      <h3>回帰直線</h3>
      <p>相関がある散布図において、各プロットに最も近い直線を<strong>回帰直線</strong>といいます。回帰直線は$y = ax + b$と表し、$x$を<b>説明変数</b>、$y$を<b>目的変数</b>、傾き$a$と切片$b$を<b>回帰係数</b>といいます。この方程式を用いることで、未観測のデータの推測や要因の分析をすることができます。</p>

      <h3>最小二乗法</h3>
      <p>$x$の値によって求められる直線上の値$y$と実際の値との差を<strong>残差</strong>といいます。各プロットの残差を２乗した値の総和が最小になるような係数を求めることで、回帰式を求めることができます。このような方法を<strong>最小二乗法</strong>と言います。</p>
      <p>このようにして求めた回帰式が、どれくらいの精度でデータに当てはまるのかを表す指標を<strong>決定係数</strong>$R^2$といい、$0$(あまり当てはまらない)〜$1$(よく当てはまる)の範囲で値をとります。最小二乗法によって得られた回帰直線の場合、相関係数の二乗と決定係数は一致します。</p>
      
      <p class="center"><img src="./img/ss33_201.png" width="400px"></p>
      
      
      
      <h3>熊谷市の最高気温の推移</h3>
      
      <p>1950年から2023年までの熊谷市の8月の最高気温の推移は次のような散布図になります。この回帰直線は$y = 0.0438x - 50.4$となるので、1年で$0.0438$℃上昇していることがわかります。</p>
      <p>このまま上昇していった場合、2100年には、$0.0438 \times 2100 - 50.4 \fallingdotseq 41.6$℃になることが予想されます。ばらつきもあるので、さらに気温の高い場合もあると予想されます。</p>
      <p class="center"><img src="./img/ss33_002.png"></p>
      
		</article>


    
    <article>
      <h2 id="headline_3">(3) 例題</h2>
      <div id="examples"></div>
      
      <h3>例題1</h3>
      <p>次のデータセット１〜３について、次の(1)，(2)を実施しなさい。</p>			
      <ol>
        <li>xとyの相関係数を求めよ。</li>
        <li>散布図を作成し、回帰直線およびその方程式を求めよ。</li>
      </ol>
					
      <h4>(1) 相関係数</h4>
      <p>相関係数を求めるときは、<b><span class="tooltip" tooltip-data="コリレーション">CORREL関数</span></b>を使います。</p>
      <pre class="example"><code><pre><code class="excel">=CORREL(範囲1, 範囲2)</code></pre></code></pre>
      
      <h4>(2)散布図の作成</h4>
      <p>データの範囲を選択した状態で、メニューバー ＞ <b>挿入</b> ＞ <b>グラフ</b>を選択します。</p>
      <p>グラフエディタで <span class="notes">❶設定</span> ＞ <span class="notes">❷グラフの種類</span> ＞ <span class="notes">❸散布図</span>を選択します。</p>
      <p>次に、グラフエディタの <span class="notes">❹カスタマイズ</span> ＞ <span class="notes">❺系列</span> を開き、系列１の<span class="notes">❻色</span>を変更します。また、<span class="notes">❼トレンドライン</span>にチェックを入れ、<span class="notes">❽ラベル</span>で「方程式を使用」を選択すると回帰式を表示します。<span class="notes">❾決定係数を表示する</span>にチェックを入れると、決定係数を表示します。</p>
      <img src="./img/ss33_911.png" class="screen_shot" width="500px">
      
      <p>
        <details>
          <summary>
            データセット１の解答
          </summary>
          <p>相関係数：0.905</p>
          <p>
            <img src="./img/ss33_901.png">
          </p>
        </details>
      </p>
      
      <p>
        <details>
          <summary>
           データセット２の解答
          </summary>
          <p>相関係数：0.201</p>
          <p>
            <img src="./img/ss33_902.png">
          </p>
        </details>
      </p>
      
      <p>
        <details>
          <summary>
           データセット３の解答
          </summary>
          <p>相関係数：-0.746</p>
          <p>
            <img src="./img/ss33_903.png">
          </p>
        </details>
      </p>
      
      
      
      
      <h3>例題2</h3>
      <p>表１は世界の主な河川のデータである。</p>			
      <ol>
        <li>表２の相関行列を完成せよ。</li>
        <li>河川の長さと流域面積・平均流量の関係を示す散布図を作成し、回帰直線およびその方程式を求めよ。</li>
      </ol>
      
      <table>
        <tr>
          <th>河川の名称</th>
          <th width="120px">長さ(km)</th>
          <th width="120px">流域面積(千km^2)</th>
          <th width="120px">平均流量(m^3/s)</th>
        </tr>
        <tr><td>ナイル川</td><td>6,650</td><td>2,870</td><td>2,800</td></tr>
        <tr><td>アマゾン川</td><td>6,516</td><td>7,050</td><td>209,000</td></tr>
        <tr><td>長江</td><td>6,300</td><td>1,175</td><td>20,030</td></tr>
        <tr><td>ミシシッピ川  - ミズーリ川</td><td>5,971</td><td>3,250</td><td>16,200</td></tr>
        <tr><td>オビ川 - エルティシ川</td><td>5,570</td><td>2,430</td><td>12,800</td></tr>
        <tr><td>エニセイ川 - アンガラ川</td><td>5,550</td><td>2,700</td><td>17,600</td></tr>
        <tr><td>黄河</td><td>4,667</td><td>745</td><td>2,110</td></tr>
        <tr><td>レナ川</td><td>4,400</td><td>2,420</td><td>12,100</td></tr>
        <tr><td>コンゴ川</td><td>4,371</td><td>3,680</td><td>39,610</td></tr>
        <tr><td>アムール川</td><td>4,368</td><td>1,855</td><td>11,400</td></tr>
        <tr><td>マッケンジー川</td><td>4,241</td><td>1,790</td><td>10,300</td></tr>
        <tr><td>メコン川</td><td>4,123</td><td>810</td><td>16,000</td></tr>
        <tr><td>ニジェール川</td><td>4,167</td><td>1,200</td><td>9,570</td></tr>
        <tr><td>パラナ川（ラプラタ川）</td><td>3,998</td><td>3,100</td><td>14,180</td></tr>
        <tr><td>ヴォルガ川</td><td>3645</td><td>1,380</td><td>8,080</td></tr>
        <tr><td>マレー川 - ダーリング川</td><td>3,620</td><td>910</td><td>767</td></tr>
        <tr><td>シャットゥルアラブ川 - ユーフラテス川</td><td>3,596</td><td>884</td><td>856</td></tr>
        <tr><td>ユーコン川</td><td>3,184</td><td>850</td><td>6,210</td></tr>
        <tr><td>インダス川</td><td>3,180</td><td>960</td><td>7,160</td></tr>
        <tr><td>サンフランシスコ川</td><td>3,180</td><td>610</td><td>3,300</td></tr>
      
      </table>

      
      <h4>(1) 相関行列</h4>
      <p>相関行列とは、異なる変数の相関係数を表にしたものです。</p>
      
      <table>
        <tr>
          <th width="100px"></th>
          <th width="100px">長さ(km)</th>
          <th width="100px">流域面積(千km^2)</th>
          <th width="100px">平均流量(m^3/s)</th>
        </tr>
        <tr><th>長さ(km)</th><td>1</td><td>0.625</td><td>0.448</td></tr>
        <tr><th>流域面積(千km^2)</th><td>0.625</td><td>1</td><td>0.836</td></tr>
        <tr><th>平均流量(m^3/s)</th><td>0.448</td><td>0.836</td><td>1</td></tr>
      </table>
      
      <h4>(2) 散布図の作成</h4>
      <p>例題1と同様の方法で散布図を作成します。河川の長さと流域面積，河川の長さと平均流量のそれぞれについて散布図を作成してもいいですが、ここでは同じ図にまとめる方法を示します。</p>
      <p>グラフエディタ ＞ <span class="notes">❶設定</span> ＞ <span class="notes">❷グラフの種類</span> で <span class="notes">散布図</span> を選択します。</p>
      <p><span class="notes">❸データ範囲</span>を河川名から平均流量の列まで４列分選択します。</p>
      <p><span class="notes">❹X軸</span>に<span class="notes">長さ</span>を指定します。</p>
      <p><span class="notes">❺系列</span>に<span class="notes">流域面積</span>と<span class="notes">平均流量</span>を指定し、ラベルに<span class="notes">河川の名称</span>を指定します。</p>
      <p>次に、<span class="notes">❻カスタマイズ</span> ＞ 系列 <span class="notes">❼平均流量</span>を選択し、<span class="notes">❽軸</span>に<span class="notes">右軸</span>を指定すると、左軸は流域面積(千km^2)，右軸は平均流量(m^3/s)となるグラフを作成することができます。</p>
      <p class="center">
        <img src="./img/ss33_921.png" width="400px">
      </p>
      
      <p>
        <details>
          <summary>
           散布図の解答例
          </summary>
          <p>流域面積(千km^2)の回帰式：$y=0.841x-1804$</p>
          <p>平均流量(m^3/s)の回帰式：$y=17.8x-60323$</p>
          <p class="center">
            <img src="./img/ss33_922.png">
          </p>
        </details>
      </p>
      
      


      
      
      <h3>例題3</h3>
      <p>表１は熊谷市の1950年から2023年までの8月の最高気温である。</p>
      <ol>
        <li>表２に度数分布表を完成させよ。</li>
        <li>表３に最大値・最小値・四分位数を求めよ。</li>
        <li>表４に平均値・分散・標準偏差を求めよ。</li>
        <li>表５に西暦と最高気温の相関係数を求めよ。</li>
        <li>ヒストグラムを作成せよ。</li>
        <li>横軸を西暦(年)，縦軸を８月の最高気温(℃)とする散布図を作成し、回帰直線およびその方程式を求めよ。</li>
      </ol>
      <p>
        <details>
          <summary>
           (5) ヒストグラムの解答
          </summary>
          <p>
            <img src="./img/ss31_001.png">
          </p>
        </details>
      </p>
      <p>
        <details>
          <summary>
           (6) 最高気温の推移の解答
          </summary>
          <p>回帰式：$y=0.0438x-50.4$</p>
          <p class="center">
            <img src="./img/ss33_002.png">
          </p>
        </details>
      </p>
		</article>
    
    
	</section>

  

	<section id="examples_and_questions"><!-- script_pages.js --></section>
	
	
    
    
</body>
</html>
